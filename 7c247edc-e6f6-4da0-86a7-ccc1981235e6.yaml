- defaultTab: nodes
  description: |-
    Applies a tag (pre-existing) to all devices in CNC
    ---
    To create tags, run the following job [CNC/Configuration/CNC - Create Tags](/project/CNC/job/show/801e3747-5afc-4a08-861f-92306ce08eba)
  executionEnabled: true
  group: CNC/Configuration
  id: 7c247edc-e6f6-4da0-86a7-ccc1981235e6
  loglevel: INFO
  name: CNC - Tag Devices [ALL]
  nodeFilterEditable: false
  options:
  - enforced: true
    label: CNC POD
    name: cnc-pod
    required: true
    valuesUrl: file:/opt/cw/options/cw-environments.json
  - delimiter: ','
    description: '> Needs to exist'
    label: Tag Name
    multivalued: true
    name: tag
    required: true
  plugins:
    ExecutionLifecycle: null
  scheduleEnabled: true
  sequence:
    commands:
    - description: Get current device list
      jobref:
        group: CNC/Devices
        importOptions: true
        name: CNC - Device Details (all)
        uuid: fe7a67f3-81bf-44c0-9361-fd2d7afb3cab
    - description: create payload
      plugins:
        LogFilter:
        - config:
            invalidKeyPattern: \s|\$|\{|\}|\\
            logData: 'true'
            name: payload
            regex: (.*)
          type: key-value-data
      script: 'jq -c ''{"data":[.[] | {"uuid":.id,"tag_names":["@option.tag@"]}]}''
        /opt/cw/options/@option.cnc-pod@-devices-short.json'
    - description: get vars
      jobref:
        group: CNC/Configuration
        importOptions: true
        name: get key vars
        uuid: c3b0db66-3fdd-49b7-a5b5-4261a0ff3463
    - configuration:
        authentication: None
        body: ${data.payload*}
        checkResponseCode: 'false'
        headers: '{"Content-Type": "application/json","Authorization": "Bearer ${export.cwtoken}"}'
        method: PATCH
        printResponse: 'true'
        printResponseToFile: 'false'
        proxySettings: 'false'
        remoteUrl: https://${export.cwvip}:30603/crosswork/inventory/v1/nodes
        sslVerify: 'false'
        timeout: '30000'
      description: Patch tags to devices
      nodeStep: false
      type: edu.ohio.ais.rundeck.HttpWorkflowStepPlugin
    keepgoing: false
    strategy: node-first
  uuid: 7c247edc-e6f6-4da0-86a7-ccc1981235e6

