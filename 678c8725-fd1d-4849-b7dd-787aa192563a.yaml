- defaultTab: nodes
  description: Add new DNS entries
  executionEnabled: true
  group: CNC/Setup
  id: 678c8725-fd1d-4849-b7dd-787aa192563a
  loglevel: INFO
  name: DNS - Add Option
  nodeFilterEditable: false
  options:
  - label: User friendly name of DNS Server entry
    name: dns-name
    required: true
  - label: IP or DNS name of DNS Server
    name: dns-server
    required: true
  - description: 'Selected by default? `true` = yes, `false` = no.'
    enforced: true
    label: Set Default
    name: default
    required: true
    value: 'false'
    values:
    - 'false'
    - 'true'
    valuesListDelimiter: ','
  - delimiter: ','
    description: '> Current DNS Server list, as shown in provisioning screens'
    enforced: true
    label: Current DNS Server Entries
    multivalueAllSelected: true
    multivalued: true
    name: dns-servers-current
    valuesUrl: file:/opt/cw/options/dns-servers.json
  plugins:
    ExecutionLifecycle: null
  scheduleEnabled: true
  sequence:
    commands:
    - description: Add new entry
      script: |-
        file=/opt/cw/options/dns-servers.json
        filetmp=/opt/cw/tmp/dns-servers.tmp
        if [ ! -f "$file" ]; then echo "[]" > "$file"; fi
        jq '. += [{"name":"@option.dns-name@","value":"@option.dns-server@","selected":@option.default@}]' $file > $filetmp
        \cp $filetmp $file
    keepgoing: false
    strategy: node-first
  uuid: 678c8725-fd1d-4849-b7dd-787aa192563a

