- defaultTab: nodes
  description: |+
    CNC ZTP Devices
    # Overview
    This will display CNN ZTP Device information for a single device

  executionEnabled: true
  group: CNC/ZTP
  id: 38e0627f-29db-438c-9568-6699b8f18c05
  loglevel: INFO
  name: ZTP - Single Device INFO
  nodeFilterEditable: true
  options:
  - name: device
    regex: \S+
    required: true
  plugins:
    ExecutionLifecycle: null
  scheduleEnabled: true
  sequence:
    commands:
    - description: get images
      exec: ls -latrh /images/*.gz
    - configuration:
        command: 'curl -k --location --request POST ''https://192.168.226.111:30603/crosswork/sso/v1/tickets?username=admin&password=Cisco!123''  --header
          ''Content-Type: application/x-www-form-urlencoded''  --header ''Accept:
          text/plain''  --header ''Cache-Control: no-cache'' --data-raw '''''
      description: Get-TICKET
      nodeStep: true
      plugins:
        LogFilter:
        - config:
            invalidKeyPattern: \s|\$|\{|\}|\\
            logData: 'true'
            name: TICKET
            regex: (.*)
          type: key-value-data
      type: localexec
    - configuration:
        command: 'curl -k --location --request POST ''https://192.168.226.111:30603/crosswork/sso/v1/tickets/${data.TICKET}''
          --header ''Content-Type: application/x-www-form-urlencoded'' --header ''Accept:
          text/plain'' --header ''Cache-Control: no-cache'' --data-urlencode ''service=https://198.18.134.219:30603/app-dashboard'''
      description: Get TOKEN
      nodeStep: true
      plugins:
        LogFilter:
        - config:
            invalidKeyPattern: \s|\$|\{|\}|\\
            logData: 'true'
            name: TOKEN
            regex: (.*)
          type: key-value-data
      type: localexec
    - configuration:
        command: 'curl -k --location --request POST ''https://192.168.226.111:30603/crosswork/ztp/v1/devices/query''
          --header ''Authorization: Bearer ${data.TOKEN}'' --header ''Content-Type:
          application/json'' --data-raw ''{"filter":{"hostName":"${option.device}"},"filterData":{"PageSize":30,"PageNum":0}}'''
      description: GET Device Data
      nodeStep: true
      type: localexec
    keepgoing: false
    strategy: node-first
  uuid: 38e0627f-29db-438c-9568-6699b8f18c05

