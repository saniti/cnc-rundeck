- defaultTab: nodes
  description: 'Creates a new node, or will overwrite an existing one.'
  executionEnabled: true
  group: Rundeck Nodes
  id: 4f8a5b3e-bba3-454a-96d2-d7b5fd4118aa
  loglevel: INFO
  name: Create a New node
  nodeFilterEditable: false
  options:
  - enforced: true
    label: Node Family
    name: node-family
    required: true
    value: unix
    values:
    - unix
    - windows
    valuesListDelimiter: ','
  - description: '> IP Address of host'
    label: IP Address
    name: hostname
    required: true
  - description: '> Friendly name for the node, preferably short and meaningful'
    name: node-name
    required: true
    valuesUrl: file:/opt/cw/nodes.json
  - description: '`ubuntu`,`centos`,`Linux` - optional'
    label: OS Name
    name: os-name
    required: true
    value: Linux
    values:
    - Linux
    - Windows
    - centos
    - ubuntu
    valuesListDelimiter: ','
  - label: Description (optional)
    name: description
    value: node
  - description: '> user name on the target server, needs to match the `password-storage-path`'
    label: User Name
    name: user-name
    required: true
    value: admin
  - description: |-
      The rundeck path to the storage credentials. Needs to match the `user-name` property
      > Default: keys/default/admin
    name: password-storage-path
    required: true
    value: keys/default/admin
  - enforced: true
    hidden: true
    name: ssh-authentication
    required: true
    value: password
    values:
    - password
    valuesListDelimiter: ','
  - delimiter: ','
    description: 'tags are how rundeck finds nodes. Select one or more from the list,
      or create your own'
    multivalued: true
    name: tags
    values:
    - cdg
    - cnc
    - cnpr
    - enb
    - license
    - lwr
    - nso
    - ssm
    - swr
    valuesListDelimiter: ','
  plugins:
    ExecutionLifecycle: null
  scheduleEnabled: true
  sequence:
    commands:
    - script: |
        echo '{"@option.node-name@": {
            "tags": "@option.tags@",
            "osFamily": "@option.node-family@",
            "username": "@option.user-name@",
            "osVersion": "ubuntu",
            "osArch": "x86_64",
            "description": "@option.description@",
            "hostname": "@option.hostname@",
            "osName": "@option.os-name@",
            "ssh-authentication" : "@option.ssh-authentication@",
            "ssh-password-storage-path": "@option.password-storage-path@"
          }
        }' > /opt/cw/nodes/@option.node-name@.json
    - description: refresh node list
      nodeStep: false
      type: source-refresh-plugin
    - description: Update node list
      jobref:
        group: Rundeck Nodes
        name: Create Node List
        uuid: 3bb2f61a-d50f-49c3-b670-a320ea35f8d3
    keepgoing: false
    strategy: node-first
  uuid: 4f8a5b3e-bba3-454a-96d2-d7b5fd4118aa

